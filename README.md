# 图片水印去除与下载工具

一个Chrome浏览器扩展，可自动去除豆包(doubao.com)、即梦(jimeng.ai/jianying.com)和字节跳动图片上的水印，并支持直接下载无水印图片。

## 最新更新

- **新增图片下载功能**：点击按钮可直接下载页面上的无水印图片
- 优化对即梦剪映(jimeng.jianying.com)网站的兼容性
- 修复图片显示问题
- 改进按钮UI设计，鼠标悬停时显示文字，平时只显示图标
- 增加智能过滤，只下载大于100x100像素的图片

## 功能特点

- 自动检测并下载豆包、即梦和字节跳动图片的无水印版本
- 可处理直接加载或通过CSS背景加载的图片
- 处理动态加载的图片
- 在支持的网站上提供右上角悬浮按钮，一键下载无水印图片
- 简洁的用户界面，支持手动触发

## 技术架构

### 核心文件结构
```
├── manifest.json          # 扩展配置文件
├── background.js          # 后台服务脚本
├── content-script.js      # 内容脚本
├── content-style.css      # 内容脚本样式
├── popup.html            # 弹出窗口HTML
├── popup.js              # 弹出窗口脚本
├── images/               # 图标资源
└── test-*.html           # 测试页面
```

### 技术实现

- **Manifest V3**: 使用最新的Chrome扩展API
- **declarativeNetRequest**: 拦截和修改网络请求
- **Content Scripts**: 页面内容操作和DOM修改
- **Service Worker**: 后台处理和权限管理
- **Downloads API**: 文件下载功能

## 工作原理

此扩展使用多种方法来去除水印并下载图片：

1. **URL重写**：扩展使用Chrome的`declarativeNetRequest` API拦截图片请求并修改URL，去除水印参数。

2. **DOM修改**：内容脚本扫描页面上已加载的图片，并在下载时移除水印参数。

3. **直接下载**：获取去除水印后的图片并直接保存到本地。

## 安装方法

### 手动安装（开发者模式）

1. 下载或克隆此仓库
```bash
git clone https://github.com/your-username/watermark-remover-extension.git
```

2. 打开Chrome，访问 `chrome://extensions/`
3. 启用"开发者模式"（右上角的开关）
4. 点击"加载已解压的扩展程序"，选择包含扩展文件的文件夹
5. 扩展程序已安装并可以使用

## 使用方法

扩展程序在后台自动工作，同时也支持手动操作：

1. **自动模式**：当您访问包含豆包、即梦或字节跳动图片的网页时，扩展会自动拦截并修改图片请求，去除水印参数。

2. **手动模式**：在支持的网站上，您会在页面右上角看到一个浮动按钮。
   - 鼠标悬停在按钮上时会显示"下载无水印图片"文字
   - 点击按钮，扩展会扫描页面上所有符合条件的图片
   - 自动下载检测到的无水印图片到您的电脑

3. **扩展图标**：您也可以点击Chrome工具栏中的扩展图标，在弹出窗口中使用功能。

## 支持的网站和图片格式

- **豆包**（doubao.com）图片
- **即梦**（jimeng.ai）图片
- **即梦剪映**（jimeng.jianying.com）网站上的按钮（但不处理图片，避免加载错误）
- **字节跳动**（byteimg.com）图片
- 支持各种水印格式：`-watermark`, `-dark-watermark`, `~tplv-`, 等

## 开发和测试

项目包含多个测试页面用于开发调试：

- `test.html` - 基础测试页面
- `test-doubao.html` - 豆包网站测试
- `test-jimeng.html` - 即梦网站测试
- `test-jianying.html` - 剪映网站测试

### 本地开发

1. 修改代码后，在Chrome扩展管理页面点击"重新加载"
2. 使用测试页面验证功能
3. 检查控制台输出和网络请求

## 故障排除

如果按钮没有显示或图片下载失败：

1. 确保扩展已启用并拥有正确的权限
2. 刷新页面，有时需要完全加载后才能显示按钮
3. 在某些网站上（特别是即梦剪映网站），扩展会限制自动处理图片以避免加载错误
4. 如果下载失败，可能是由于网站限制或图片格式不兼容

## 隐私政策

此扩展不收集任何数据。它只在您的设备上修改图片URL并下载图片，不会向外部服务器发送任何信息。

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。

## 更新日志

### v1.2
- 新增图片下载功能
- 优化UI设计
- 改进网站兼容性

### v1.1
- 支持即梦剪映网站
- 修复图片显示问题

### v1.0
- 初始版本
- 支持豆包和即梦网站 